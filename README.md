# educational case 1
*Выполнен самостоятельно*

### Задачи:
1. Определите диапазон заработных плат в общем, а именно средние значения, минимумы и максимумы нижних и верхних порогов зарплаты.
2. Выявите регионы и компании, в которых сосредоточено наибольшее количество вакансий.
3. Проанализируйте, какие преобладают типы занятости, а также графики работы.
4. Изучите распределение грейдов (Junior, Middle, Senior) среди аналитиков данных и системных аналитиков.
5. Выявите основных работодателей, предлагаемые зарплаты и условия труда для аналитиков.
6. Определите наиболее востребованные навыки (как жёсткие, так и мягкие) для различных грейдов и позиций.

Описание данных:
| Название столбца   | Тип данных | Описание                                            |
|--------------------|------------|-----------------------------------------------------|
| id                 | int4       | Идентификатор объявления. Первичный ключ           |
| name               | varchar    | Название вакансии                                  |
| published_at       | timestamp  | Дата выставления вакансии                          |
| employer           | varchar    | Компания, которая ищет работника                    |
| department         | varchar    | Отделение компании, в котором необходим сотрудник  |
| area               | varchar    | Расположение компании                              |
| experience         | varchar    | Необходимый опыт и ранг кандидата                   |
| schedule           | varchar    | График работы                                      |
| employment         | varchar    | Занятость: полная или частичная                     |
| salary_from        | numeric    | Заработная плата в категории «от»                   |
| salary_to          | numeric    | Заработная плата в категории «до»                   |
| salary_bin         | varchar    | Заработная плата в категории «зарплатная вилка»     |
| key_skills_1       | varchar    | Первый ключевой навык, который требуется от кандидата |
| key_skills_2       | varchar    | Второй ключевой навык, который требуется от кандидата |
| key_skills_3       | varchar    | Третий ключевой навык, который требуется от кандидата |
| key_skills_4       | varchar    | Четвёртый ключевой навык, который требуется от кандидата |
| soft_skills_1      | varchar    | Первый дополнительный навык, который требуется от кандидата |
| soft_skills_2      | varchar    | Второй дополнительный навык, который требуется от кандидата |
| soft_skills_3      | varchar    | Третий дополнительный навык, который требуется от кандидата |
| soft_skills_4      | varchar    | Четвёртый дополнительный навык, который требуется от кандидата |

Название таблицы — `public.parcing_table`

#### 1. Определить диапазон заработных плат.
```SQL
SELECT ROUND(AVG(salary_from), 2) AS avg_salary_from,
       ROUND(AVG(salary_to), 2) AS avg_salary_to,
       MIN(salary_from) AS min_salary_from,
       MAX(salary_from) AS max_salary_from,
       MIN(salary_to) AS min_salary_to,
       MAX(salary_to) AS max_salary_to
FROM public.parcing_table;
```
Таблица:
| avg_salary_from | avg_salary_to | min_salary_from | max_salary_from | min_salary_to | max_salary_to |
|-|-|-|-|-|-|
| 109525.09 |     153846.71 |            50|        398000 |       25000 |      497500 |

Выводы:
Средняя зарплата в категории «от» составляет около 109525 рублей, а в категории «до» — около 153846 рублей. Это указывает на то, что работодатели готовы платить аналитикам данных и системным аналитикам в среднем около 130000 рублей. 
Минимальная предлагаемая зарплата начинается с 50 рублей, что, скорее всего, является ошибкой данных, а максимальная достигает 497500 рублей.

#### 2. Выявить регионы и компании, в которых сосредоточено наибольшее количество вакансий.
2.1 Регионы:
```SQL
SELECT area,
       COUNT(*) AS num_vacancies
FROM public.parcing_table
GROUP BY area
ORDER BY num_vacancies DESC;
```
Таблица:
|            area              | num_vacancies |
|-|-|
| Москва                        |          1247 |
| Санкт-Петербург               |           181 |
| Екатеринбург                  |            51 |
| Нижний Новгород               |            33 |
| Новосибирск                   |            33 |
| ...  | ... |

Выводы:
Москва и Санкт-Петербург — лидеры по количеству вакансий. Это неудивительно, учитывая, что это крупнейшие города с развитой инфраструктурой и большим количеством компаний. 
В Екатеринбурге, Нижнем Новгороде и Новосибирске также значительное количество вакансий. Это указывает на развитый рынок труда для аналитиков данных в этих регионах.

2.2 Компании:
```SQL
SELECT employer,
       COUNT(*) AS num_vacancies 
FROM public.parcing_table 
GROUP BY employer 
ORDER BY num_vacancies DESC;
```

Таблица:
| employer | num_vacancies |
|-|-|
| СБЕР | 243 |
| WILDBERRIES | 43 |
| Ozon | 34 |
| Банк ВТБ (ПАО) | 28 |
| Т1 | 26 |
| МАГНИТ, Розничная сеть | 24 |
| МТС | 22 |
| Okko | 19 |
| Центральный банк Российской Федерации | 16 |
| Ростелеком | 15 |
| Правительство Москвы | 15 |
| Яндекс | 15 |
| Райффайзен Банк | 14 |
| ... | ... |

Выводы:
СБЕР предлагает 243 вакансии и является крупнейшим работодателем для аналитиков данных. 
Это может говорить о значительных инвестициях в аналитику и технологические решения в компании. WILDBERRIES, Ozon и другие крупные компании также активно ищут специалистов в области данных, 
что говорит о высоком спросе на аналитиков в крупных корпорациях.

2.3 Компании по регионам (исключая Москву и Санкт-Петебрург как два заметно доминирующих города по количетсву вакансий):
```SQL
SELECT area,
       employer,
       COUNT(*) AS num_vacancies 
FROM public.parcing_table 
WHERE area NOT LIKE '%Москва%' 
      AND area NOT LIKE '%Санкт-Петербург%'
GROUP BY area, employer 
ORDER BY num_vacancies DESC;
```

Таблица: 
| area | employer | num_num_vacancies |
| - | - | - | 
| Нижний Новгород | СБЕР | 9 |
| Владивосток | DNS Головной офис | 8 |
| Екатеренбург | СБЕР | 8 |
| Владивосток | DNS Технологии | 7 |
| Екатеринбург | Контур | 7 |
| Адыгейск | СБЕР | 5 |
|...|...|...|

Выводы:
В регионах России СБЕР так же занимает лидирующие места по количеству вакансий для аналитиков. 
Банк также предлагает вакансии не только в крупных городах, но и в городе с населением менее 15 тыс. человек (Адыгейск).

#### 3. Проанализировать, какие преобладают типы занятости, а также графики работы.
3.1 Количество вакансий по типу занятости:
```SQL
SELECT employment,
       COUNT(*) AS num_vacancies
FROM public.parcing_table 
GROUP BY employment 
ORDER BY num_vacancies DESC;
```
Таблица:
   |  employment      | num_vacancies |
| - | - |
|  Полная занятость    |          1764 |
|  Частичная занятость |            16 |
|  Стажировка          |            16 |
|  Проектная работа    |             5 |

Выводы:
Подавляющее большинство вакансий (1764) предлагают полную занятость.
Это указывает на то, что работодатели предпочитают нанимать аналитиков данных и системных аналитиков на постоянные позиции. 
Возможно, дело в необходимости глубоко погружаться в проекты и долго в них участвовать.

3.1 Количество вакансий по графику работы:
```SQL
SELECT schedule,
       COUNT(*) AS num_vacancies 
FROM public.parcing_table 
GROUP BY schedule 
ORDER BY num_vacancies DESC;
```
Таблица:
    | schedule     | num_vacancies |
| - | - |
| Полный день      |          1441 |
|  Удаленная работа |           310 |
|  Гибкий график    |            41 |
|  Сменный график   |             9 |

Выводы:
Большинство вакансий (1441) предлагают работу с полным днём. 
Однако значительное количество вакансий (310) также позволяет удалённую работу. 
Это указывает на то, что работодатели готовы быть гибкими в современных условиях.
Возможно, в ответ на пандемию COVID-19  и изменения в предпочтениях работников.

#### 4. Изучить распределение грейдов среди аналитиков данных и системных аналитиков.
4.1 Выявление грейда требуемых специалистов по опыту:
```SQL
SELECT experience,
       COUNT(*) AS num_vacancies
FROM public.parcing_table 
GROUP BY experience 
ORDER BY num_vacancies DESC;
```
Таблица:
   |  experience       | num_vacancies |
| - | - |
|  Junior+ (1-3 years)   |          1091 |
|  Middle (3-6 years)    |           555 |
|  Junior (no experience) |           142 |
|  Senior (6+ years)     |            13 |

Вывод:
Наибольшее количество вакансий предназначено для специалистов с опытом от 1 до 3 лет (Junior+), 
что свидетельствует о высоком спросе на специалистов начального и среднего уровней. 
Вакансий для Middle-специалистов (3–6 лет) также много, в то время как спрос на Senior-специалистов (6+ лет) крайне низкий, возможно, из-за узкого круга специалистов с таким уровнем опыта или предпочитаемых долгосрочных позиций.
Однако важно понимать, что Senior-аналитиков могут чаще искать по другим каналам.

4.2 Определение доли грейдов среди вакансий аналитиков данных и системных аналитиков:
```SQL
SELECT experience,
       COUNT(*) AS num_vacancies,
       ROUND(COUNT(*) * 100 / (
            SELECT COUNT(*)
            FROM public.parcing_table 
            WHERE name LIKE '%Аналитик данных%' 
               OR name LIKE '%Системный аналитик%'
       )::NUMERIC, 2) AS percent_vacancies
FROM public.parcing_table
WHERE name LIKE '%Аналитик данных%' 
   OR name LIKE '%Системный аналитик%'
GROUP BY experience
ORDER BY percent_vacancies DESC;
```

Таблица:
| experience | num_vacancies | percent_vacancies |
|-|-|-|
| Junior+ (1-3 years) |	751	| 64.91 |
| Middle (3-6 years) |	296	| 25.58 |
| Junior (no experince)	| 105 |	9.08 |
| Senior (6+ years) |	5 |	0.43 |

Вывод: 
Большинство вакансий для аналитиков данных и системных аналитиков предназначены для специалистов уровня Junior+ (64.91%) и Middle (25.58%). 
Это подтверждает высокую потребность в специалистах начального и среднего уровней. 
Доли вакансий для стажёров (9.08%) и Senior (0.43%) значительно ниже, что может указывать на меньшую потребность в новичках и высококвалифицированных специалистах.

#### 5. Выявите основных работодателей, предлагаемые зарплаты и условия труда для аналитиков.
```SQL
SELECT employer,
       COUNT(*) AS num_vacancies,
       ROUND(AVG(salary_from), 2) AS avg_salary_from,
       ROUND(AVG(salary_to), 2) AS avg_salary_to,
       employment,
       employment
FROM public.parcing_table 
WHERE name LIKE '%Аналитик данных%' OR name LIKE '%Системный аналитик%'
GROUP BY employer, employment, schedule 
ORDER BY num_vacancies DESC;
```

Таблица:
|employer|num_vacancies|avg_salary_from|avg_salary_to|employment|employment|
|-|-|-|-|-|-|
|СБЕР|	103|	112000.00|	73333.33|	Полная занятость|	Полный день|
|Банк| ВТБ (ПАО)	|25	|[NULL]	|	Полная занятость|	Полный день|
|Ozon	|18	|[NULL]	|[NULL]	|Полная занятость|	Полный день| 
|...|...|...|...|...|...|

Вывод:
СБЕР выделяется как основной работодатель для аналитиков данных и системных аналитиков с 103 вакансиями и средней зарплатой от 112000 рублей до 73333 рублей. 
*Средняя зарплата «до» ниже средней зарплаты «от» — скорее всего, СБЕР часто пишет сумму «до», не указываю сумму «от».*
Основной тип занятости в СБЕР — полная занятость с полным рабочим днём. Значит, компания предпочитает длительное сотрудничество с сотрудниками.
Банк ВТБ (ПАО) и Ozon также предлагают достаточно вакансий с аналогичными условиями занятости.
Это подтверждает тенденцию крупных компаний нанимать аналитиков данных на полную занятость с фиксированным рабочим графиком.

#### 6. Определить наиболее востребованные навыки (как жёсткие, так и мягкие) для различных грейдов и позиций.
6.1 Определение наиболее востребованных жестких навыков:
```SQL
WITH hard_skills AS (
    SELECT UNNEST(ARRAY[key_skills_1, key_skills_2, key_skills_3, key_skills_4]) AS hard_skill
    FROM public.parcing_table
)
SELECT hard_skill,
       COUNT(*) AS num_mention
FROM hard_skills
WHERE hard_skill IS NOT NULL
GROUP BY hard_skill
ORDER BY num_mention DESC
LIMIT 3;
```
Таблица:
|hard_skill|num_mention|
|-|-|
|SQL|	760|
|Python	|452|
|Анализ данных|	395|

Вывод: 
Самые востребованные инструменты для аналитика - SQL (760) и Python (452), что подчёркивает важность работы с базами данных и возможность эффективно обрабатывать и анализировать данные и создавать интерактивные визуализации.
Среди ключевых навыков также упоминается и «Анализ данных», что логично для позиций аналитиков данных.

6.2 Определение наиболее востребованных мягких навыков:
```SQL
WITH soft_skills AS (
       SELECT UNNEST(ARRAY[soft_skills_1,soft_skills_2, soft_skills_3, soft_skills_4]) AS soft_skill
       FROM public.parcing_table
  )
SELECT soft_skill,
       COUNT(*) AS num_mention
FROM soft_skills
WHERE soft_skill IS NOT NULL
GROUP BY soft_skill
ORDER BY num_mention DESC
LIMIT 3;
```
Таблица:
|soft_skill|num_mention|
|- |- |
|Документация	|234|
|Коммуникация	|181|
|Аналитическое мышление	|109|

Вывод:
Самый востребованный мягкий навык - документация (234 упоминания), что указывает на необходимость ведения точных записей и отчётов.
Навык "Коммуникация" также отмечен одним из самых востребованных, что позволяет аналитику четко доносить свои выводы и рекомендации до заинтересованных сторон, убеждать их в необходимости тех или иных решений и влиять на бизнес-стратегию.
"Аналитическое мышление" помогает аналитику структурировано подходить к решению задач и делать обоснованные выводы для принятия взвешенных решений.
 
